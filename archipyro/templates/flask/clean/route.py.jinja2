"""
Routes for {{ name | to_pascal_case }} resource.
"""
from typing import Dict, Any
from flask import Blueprint, request
{%- if is_resource %}
from app.views.{{ name | lower }} import {{ name | to_pascal_case }}View
from app.exceptions import NotFoundError, ValidationError
{%- else %}
# from app.views.{{ name | lower }} import {{ name | to_pascal_case }}View
{%- endif %}

{{ name | lower }}_bp = Blueprint('{{ name | lower }}', __name__)

{%- if is_resource %}

@{{ name | lower }}_bp.route('/', methods=['GET'])
def get_all():
    """
    Get all {{ name | lower }} records.
    
    Returns:
        JSON response with list of {{ name | lower }} records
    """
    try:
        return {{ name | to_pascal_case }}View.get_all_{{ name | lower }}s()
    except Exception as e:
        # Error handling is done in the view
        raise


@{{ name | lower }}_bp.route('/<{%- if config.database != 'MongoDB' %}int:{%- endif %}id>', methods=['GET'])
def get_by_id(id{%- if config.database != 'MongoDB' %}: int{%- endif %}):
    """
    Get a {{ name | lower }} by ID.
    
    Args:
        id: {{ name | to_pascal_case }} ID{%- if config.database == 'MongoDB' %} (MongoDB ObjectId string){%- else %} (integer){%- endif %}
        
    Returns:
        JSON response with {{ name | lower }} data
    """
    try:
        return {{ name | to_pascal_case }}View.get_{{ name | lower }}_by_id(id)
    except NotFoundError:
        raise
    except Exception as e:
        raise


@{{ name | lower }}_bp.route('/', methods=['POST'])
def create():
    """
    Create a new {{ name | lower }}.
    
    Request body (JSON):
        {
            "field1": "value1",
            "field2": "value2"
        }
    
    Returns:
        JSON response with created {{ name | lower }} data
    """
    try:
        data: Dict[str, Any] = request.get_json() or {}
        return {{ name | to_pascal_case }}View.create_{{ name | lower }}(data)
    except ValidationError:
        raise
    except Exception as e:
        raise


@{{ name | lower }}_bp.route('/<{%- if config.database != 'MongoDB' %}int:{%- endif %}id>', methods=['PUT'])
def update(id{%- if config.database != 'MongoDB' %}: int{%- endif %}):
    """
    Update an existing {{ name | lower }}.
    
    Args:
        id: {{ name | to_pascal_case }} ID{%- if config.database == 'MongoDB' %} (MongoDB ObjectId string){%- else %} (integer){%- endif %}
        
    Request body (JSON):
        {
            "field1": "new_value1"
        }
    
    Returns:
        JSON response with updated {{ name | lower }} data
    """
    try:
        data: Dict[str, Any] = request.get_json() or {}
        return {{ name | to_pascal_case }}View.update_{{ name | lower }}(id, data)
    except NotFoundError:
        raise
    except Exception as e:
        raise


@{{ name | lower }}_bp.route('/<{%- if config.database != 'MongoDB' %}int:{%- endif %}id>', methods=['DELETE'])
def delete(id{%- if config.database != 'MongoDB' %}: int{%- endif %}):
    """
    Delete a {{ name | lower }}.
    
    Args:
        id: {{ name | to_pascal_case }} ID{%- if config.database == 'MongoDB' %} (MongoDB ObjectId string){%- else %} (integer){%- endif %}
        
    Returns:
        JSON response confirming deletion
    """
    try:
        return {{ name | to_pascal_case }}View.delete_{{ name | lower }}(id)
    except NotFoundError:
        raise
    except Exception as e:
        raise

{%- else %}

# Dummy route for standalone generation
# TODO: Implement {{ name | to_pascal_case }}View methods
# view = {{ name | to_pascal_case }}View()

@{{ name | lower }}_bp.route('/', methods=['GET'])
def index():
    """
    Example route endpoint.
    
    Returns:
        JSON response with greeting message
    """
    from flask import jsonify
    return jsonify({"message": "Hello from {{ name }} route!"})
{%- endif %}
